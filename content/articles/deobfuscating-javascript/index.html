{"title": "Deobfuscating JavaScript", "date": "2009-01-12 16:28:48", "description": "", "categories": ["security", "jsdeobfuscator"], "slug": "deobfuscating-javascript"}

	<p>A few months ago I read a post in the WebSense Security Labs blog: <a href="http://securitylabs.websense.com/content/Blogs/3198.aspx">The Ultimate Deobfuscator</a>. Wow, pretty impressive hacking effort and nice tricks to hook JavaScript <code>eval()</code> function and <code>document.write()</code> in Internet Explorer. But couldn&#8217;t you use JS Debugger hooks in Firefox to do the same thing with only a few lines of code? And then maybe even more generic because <code>eval()</code> and <code>document.write()</code> are certainly not the only ways to generate JavaScript code on the fly (out of the top of my head: changing <code>window.location</code> to a JavaScript <span class="caps">URL</span>, event handler attributes or <code>setTimeout()</code> with a string parameter).</p>

	<p>Anyway, I finally took the time and actually wrote that Firefox extension: <a href="https://addons.mozilla.org/addon/10345">JavaScript Deobfuscator</a> (<a href="http://hg.mozdev.org/adblockplus/file/tip/jsdeobfuscator/">source code</a>). It adds a &#8220;Watch code execution&#8221; menu item to Tools menu, once checked all JavaScript compiled on a web page is posted as a message to Error Console. Nice side-effect: the JavaScript engine reformats the code to make it more readable. Downside: JavaScript performance goes down the drain, so using the browser with that option always switched on really isn&#8217;t recommendable.</p>

	<p>The result is quite impressive with the obscure JavaScript code on the default Firefox home page. All the sudden you can see the functions executing there and it is possible to understand what they do. But that&#8217;s relatively little code of course, with something like GMail the code keeps coming so fast that it is impossible to keep track. Somebody want to create a better presentation for the data?</p>