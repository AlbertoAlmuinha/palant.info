---
categories:
- security
date: "2007-11-05 16:18:44"
description: ""
slug: predictable-whitelists-strike-again
title: Predictable whitelists strike again
---

<p>A little more than half a year ago I wrote an article on how <a href="http://palant.de/2007/03/15/blacklists-whitelists-and-security">security solutions using whitelists are better than those using blacklists</a>. At the same time I noted that even using whitelists is not always enough&nbsp;&mdash; for example when your whitelist is predictable and the attacker can make sure the whitelisting rule applies to him. NoScript extension was the example I used, and its author reacted by adding &#8220;<span class="caps">XSS</span> protection&#8221; assuming that this would invalidate my claims.</p>

	<p>Well, it doesn&#8217;t. <span class="caps">XSS</span> is a very complex problem, and all the simple solutions to this problem usually turn out wrong. Which is once more confirmed by the <a href="http://ha.ckers.org/blog/20071104/owning-hackersorg-or-not/">attack on the security expert RSnake</a>. The attackers knew that RSnake is using NoScript, so they simply included NoScript in their plan. They guessed that RSnake would whitelist his own site, found an <span class="caps">XSS</span> vulnerability there, used an <span class="caps">XSS</span> attack NoScript wouldn&#8217;t stop&nbsp;&mdash; and they would have been able to run JavaScript despite NoScript hadn&#8217;t their guess been wrong. That&#8217;s exactly the kind of attack I spoke about in my article.</p>

	<p>Now RSnake was in a much better situation than the majority of NoScript users. He did not only notice the attack that executed in background, he probably didn&#8217;t even have a single entry in his NoScript whitelist to be exploited. Too bad that 99% of the users never configure anything&nbsp;&mdash; meaning that they still use the default whitelisting entries that NoScript comes with and that I warned against a while ago. Instead of cutting this list down to the bare minimum (ideally: zero), the author kept four (!) of his domains on the default whitelist&nbsp;&mdash; and Google ads, just to make sure he still gets money from people forced to visit on each NoScript update (which happens approximately once per week).</p>

	<p>To reiterate what I already stated before: if Firefox users ever come under attack (hardly ever happened so far, at least if you run the latest Firefox version)&nbsp;&mdash; for the vast majority of users NoScript will not be a help. It tends to stop lots of harmless (meaning useful) stuff but cannot be relied on when it comes to the attacks it is supposed to stop.</p>