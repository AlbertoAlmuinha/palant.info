{"title": "Blacklists, whitelists, and security", "date": "2007-03-15 03:13:08", "description": "", "categories": ["security", "adblock-plus"], "slug": "blacklists-whitelists-and-security"}

	<p>I had a <a href="http://www.wilderssecurity.com/showthread.php?t=168176">lengthy discussion</a> with Giorgio Maone (author of the NoScript extension) about what is a security solution and what isn&#8217;t. Starting point was my statement that, while being excellent for getting rid of annoyances, neither Adblock Plus nor NoScript are really security solutions. Both have the potential, so why not?</p>

	<p>Let&#8217;s look at the easier case first: Adblock Plus. Adblock Plus is structured as a blacklist, you usually specify the addresses that you don&#8217;t want to load. So if there is a security issue that can be solved by blocking a certain address you will have to add a filter for this address. Requiring an action for each single vulnerability discovered disqualifies Adblock Plus, a real security solution would need to block everything unless explicitly allowed. Right now only the extremely rare case of malware-infested ads would be blocked by default however.</p>

	<p>Ok, that isn&#8217;t exactly true. I use Adblock Plus to ensure the security of my Thunderbird. My blacklist in Thunderbird has only one filter: &#8220;&#x2A;&#8221;. Yes, I block everything unless it is explicitly allowed with an exception rule like &#8220;&#x40;&#x40;|http://img.worsethanfailure.com/&#x2A;&#8221;. So why can&#8217;t you do the same in the browser? Because it would make web surfing impossible, unlike a mail client the browser is supposed to connect to numerous different servers. Still, once two <a href="https://adblockplus.org/blog/recognizing-third-party-content">new</a> <a href="https://adblockplus.org/blog/status-of-immediate-unblocking-feature">features</a> are in place they will allow you to add some general rules to you list, e.g. &#8220;&#x2A;$object&#8221; and &#8220;&#x2A;$script,third-party&#8221;. The former will block all objects&nbsp;&mdash; those are rarely really needed and you will be able to unblock individual objects temporarily on case-by-case basis. The latter will block all scripts the page loads from third-party servers, those are always a security risk (I wonder whether this will actually break any pages). But until these features are in place and properly documented Adblock Plus isn&#8217;t a security solution.</p>

	<p>Now to NoScript. I have my doubts whether disabling JavaScript really makes browsing noteworthy more secure if you keep your browser updated (mainly because Gecko developers do such a <a href="/2007/01/05/firefox-security-the-real-picture">great job</a>). But this is a different discussion, here it is only important that NoScript&#8217;s concept is better for security purposes than that of Adblock Plus&nbsp;&mdash; NoScript is a whitelist, it only allows trusted sites to run scripts. So why isn&#8217;t it enough? Because a whitelist that can be subverted isn&#8217;t worth anything. It is enough to find a single whitelisted site with an <span class="caps">XSS</span> (Cross-Site Scripting) vulnerability and suddenly any web site can run JavaScript.</p>

	<p>Ok, you need an <span class="caps">XSS</span> vulnerability. Is it difficult to find one? In my experience&nbsp;&mdash; no. Two weeks ago I looked for <span class="caps">XSS</span> vulnerabilities on Yahoo just to prove the point and easily found 8 of them. One (and another one I found later) is still open, and I am sure that hadn&#8217;t I reported them all these vulnerabilities would still be open and allow me to run my attacks. Note that Yahoo is one of the more secure sites on NoScript&#8217;s default whitelist, the extreme case being bugzilla.mozilla.org that is vulnerable to <span class="caps">XSS</span> by design.</p>

	<p>All this together means that NoScript will only protect against an attacker who either doesn&#8217;t know about NoScript or is too lazy to work around it. Giorgio Maone said that he will remove the default whitelist which is certainly an improvement&nbsp;&mdash; but guessing what a user has in his whitelist is still easy (and NoScript users are really forced to whitelist sites). <span class="caps">IMO</span> anything that depends on attacker&#8217;s ignorance or laziness cannot be called a security solution&nbsp;&mdash; sorry, NoScript.</p>

	<p>To reiterate the point: it isn&#8217;t enough to block by default, you also have to make sure that it is reasonably complicated for an attacker to make an exception apply to him. You don&#8217;t see it only in NoScript, Internet Explorer&#8217;s zone policies suffer from the same issue&nbsp;&mdash; they become worthless the moment you manage to inject your code into some page in the trusted zone. That&#8217;s why this model was never implemented in Gecko, it only lulls users into a false sense of security. Even the whitelist in Adblock Plus suffers from this issue if used improperly&nbsp;&mdash; that&#8217;s one of the reasons I have been so <a href="https://adblockplus.org/blog/sorry-filtersetg-but-it-is-time-for-you-to-go">harsh on Filterset.G</a> that uses very general whitelisting making it easy for advertisers to create virtually unblockable ads.</p>