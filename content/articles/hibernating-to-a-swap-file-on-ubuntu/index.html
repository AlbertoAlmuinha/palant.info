{
  "title": "Hibernating to a swap file on Ubuntu",
  "date": "2017-05-30 18:11:24",
  "description": "",
  "categories": [
    "linux"
  ],
  "slug": "hibernating-to-a-swap-file-on-ubuntu"
}

	<p>Operating systems these days generally support suspending their state to disk, also called hibernation. You ask of course: why would anybody need this, with the operating system booting up as a matter of seconds anyway? See, users tend to have these fancy modern devices called laptops that run on battery power. If they run out of power it is usually a good idea for the operating system to save its state and shut down automatically, this way the user won&#8217;t loose any unsaved work and they won&#8217;t need to reopen applications. Even more fancy: a hibernation state is created when the laptop lid is closed (hybrid sleep mode), so if the power runs out while the laptop is suspended no data will be lost either.</p>

	<p>And so both Windows and macOS make sure to have hibernation functionality enabled out of the box and without any configuration whatsoever. In fact, users might not even realize that they are using it. And what about Linux you ask? After all, Linux has to be better by definition, it being not merely Open Source software but also a truly open project. This means that everybody and their dog can contribute to Linux development, and you certainly know that getting many cooks together is a sure way to get a delicious meal. Given that there are many flavors of Linux, this article is looking at Ubuntu which has been chosen by a representative survey (also, I happen to be using it right now).</p>

	<h4>How does hibernation work on Ubuntu?</h4>

	<p>By default, Ubuntu uses a kernel feature for hibernation aptly named swsusp (it ain&#8217;t a good project name as long as you can still pronounce it). But usually you don&#8217;t need to mess with the kernel, as this functionality has been properly integrated with systemd. So triggering hibernation from the command line is possible with the following command:</p>

<pre><code>sudo systemctl hibernate
</code></pre>

	<p>This will use your system&#8217;s swap to store data currently in memory, after that your computer will be shut down. Next time the system starts up, the kernel (assisted by some scripts running within the initial ramdisk) will hopefully find that data and restore it&nbsp;&mdash; and suddenly you have your previous state, just where you left of.</p>

	<p>Well, that&#8217;s if you are lucky of course. What could possibly go wrong? A bunch of things actually. The kernel doesn&#8217;t know where your swap is unless you tell it, and for some reason the Ubuntu developers decided that they don&#8217;t need to assist you with that.</p>